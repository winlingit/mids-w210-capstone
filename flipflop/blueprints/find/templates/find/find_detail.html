{% extends 'layouts/app.html' %}
{% import "macros/form.html" as f with context %}

{% block title %}Engage{% endblock %}
{% block meta_description %}Holding Congress accountable{% endblock %}

{% block body %}

<section class="content-section-b">
   <div class="container">
    <div class="row">
       <div class="col-sm-12 spacer-10">
          <a href="{{ url_for('find.find_page') }}"><< Back to Engage Your Legislators</a>
          <h2>{{ member.mem_type }} {{ member.first_name }} {{ member.last_name }}</h2>
          <a class="dark" href="https://twitter.com/@{{ member.twitter }}"><i class="fa fa-twitter-square fa-2x" aria-hidden="true"></i></a>
          <a class="dark" href="https://facebook.com/{{ member.facebook }}"><i class="fa fa-facebook-official fa-2x" aria-hidden="true"></i></a>
          <a class="dark" href="{{ member.contact_form }}"><i class="fa fa-envelope-square fa-2x" aria-hidden="true"></i></a>
          <a class="dark" href="tel:{{ member.phone }}"><i class="fa fa-phone-square fa-2x" aria-hidden="true"></i></a>
       </div>
     </div>
     <div class="row spacer-10">
      <div class="col-md-6">
        <h3>Member Details</h3>
        <ul class="lead">
          <li><b>Representing:</b> {{ member.state_abbrev }}
          {%- if member.district %}
             - District {{ member.district }}
          {%- endif %}</li>
          <li><b>Party:</b> {{ member.party }}</li>
          <li><b>Phone:</b> {{ member.phone }}</li>
          <li><b>Website:</b> <a href="{{ member.url }}">{{ member.url }}</a></li>
        </ul>
        <h3>Recent Votes</h3>
          <table class="table table-hover">
          {%- for vote in votes %}
            <tr>
              <td>
              <b>{{ vote.vote_position|upper }}</b> on 
              {%- for bill in bills %}
                {%- if vote.bill_id == bill.bill_id %}
                  <b><a href="{{ bill.url }}">{{ vote.bill_id|upper }}</a></b>: {{ bill.title }}
                {%- endif %}
              {%- endfor %}
              </td>
            </tr>
          {%- endfor %}
        </table>
      </div>
      <div class="col-md-6">
        <h3>Predicted Votes on Upcoming Bills</h3>
        <h5>Positions for On Passage Votes</h5>
        <table class="table table-hover">
            <thead>
            <tr>
              <th>BILL</th>
              <th>PREDICTED VOTE</th>
              <th>SWING PROBABILITY</th>
            </tr>
            </thead>
          <tbody id="myTable">
            {%- for prediction in top_predictions %}
            <tr>
              <td><a href="{{ url_for('find.find_page', member_id=prediction.Member.member_id) }}">{{ prediction.Member.first_name }} {{ prediction.Member.last_name }}</a>
              </td>
              <td>{{ prediction.Model.position }}</td>
              <td>{{ 100*prediction.BillPrediction.pred_probs|round(3) }}%</td>
              <td>{{ prediction.Model.model }}</td>
            </tr>
            {%- endfor %}
          </tbody>
        </table>
     </div>

</div>
</section>
{% endblock %}
